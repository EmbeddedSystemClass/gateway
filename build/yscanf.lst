ARM GAS  /tmp/ccr4ARcs.s 			page 1


   1              		.syntax unified
   2              		.cpu cortex-m4
   3              		.eabi_attribute 27, 1
   4              		.eabi_attribute 28, 1
   5              		.fpu fpv4-sp-d16
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.thumb
  16              		.syntax unified
  17              		.file	"yscanf.c"
  18              		.text
  19              	.Ltext0:
  20              		.cfi_sections	.debug_frame
  21              		.section	.text.yscanf_init,"ax",%progbits
  22              		.align	2
  23              		.global	yscanf_init
  24              		.thumb
  25              		.thumb_func
  27              	yscanf_init:
  28              	.LFB129:
  29              		.file 1 "Ourwares/yscanf.c"
   1:Ourwares/yscanf.c **** /******************************************************************************
   2:Ourwares/yscanf.c **** * File Name          : yscanf.c
   3:Ourwares/yscanf.c **** * Date First Issued  : 01/22/2019
   4:Ourwares/yscanf.c **** * Board              : 
   5:Ourwares/yscanf.c **** * Description        : For FreeRTOS sscanf'ing
   6:Ourwares/yscanf.c **** *******************************************************************************/
   7:Ourwares/yscanf.c **** 
   8:Ourwares/yscanf.c **** #include <stdint.h>
   9:Ourwares/yscanf.c **** #include <stdarg.h>
  10:Ourwares/yscanf.c **** #include <stdio.h>
  11:Ourwares/yscanf.c **** #include <string.h>
  12:Ourwares/yscanf.c **** #include "yscanf.h"
  13:Ourwares/yscanf.c **** 
  14:Ourwares/yscanf.c **** osSemaphoreId sscanfSemaphoreHandle;
  15:Ourwares/yscanf.c **** static uint8_t sw = 0;	// OTO initiationzation switch
  16:Ourwares/yscanf.c **** 
  17:Ourwares/yscanf.c **** /* **************************************************************************************
  18:Ourwares/yscanf.c ****  *  int yscanf_init(void);
  19:Ourwares/yscanf.c ****  * @brief	: Setup semaphore
  20:Ourwares/yscanf.c ****  * @return	: 0 = init executed; -1 = init already done
  21:Ourwares/yscanf.c ****  * ************************************************************************************** */
  22:Ourwares/yscanf.c **** int yscanf_init(void)
  23:Ourwares/yscanf.c **** {
  30              		.loc 1 23 0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 8
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  24:Ourwares/yscanf.c **** 	if (sw == 0)
  34              		.loc 1 24 0
ARM GAS  /tmp/ccr4ARcs.s 			page 2


  35 0000 0C4B     		ldr	r3, .L5
  36 0002 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  37 0004 93B9     		cbnz	r3, .L4
  23:Ourwares/yscanf.c **** 	if (sw == 0)
  38              		.loc 1 23 0
  39 0006 00B5     		push	{lr}
  40              	.LCFI0:
  41              		.cfi_def_cfa_offset 4
  42              		.cfi_offset 14, -4
  43 0008 83B0     		sub	sp, sp, #12
  44              	.LCFI1:
  45              		.cfi_def_cfa_offset 16
  46              	.LBB2:
  25:Ourwares/yscanf.c **** 	{
  26:Ourwares/yscanf.c **** 		sw = -1;
  47              		.loc 1 26 0
  48 000a FF22     		movs	r2, #255
  49 000c 094B     		ldr	r3, .L5
  50 000e 1A70     		strb	r2, [r3]
  27:Ourwares/yscanf.c **** 		osSemaphoreDef(sscanfSemaphore);
  51              		.loc 1 27 0
  52 0010 0023     		movs	r3, #0
  53 0012 0093     		str	r3, [sp]
  54 0014 0193     		str	r3, [sp, #4]
  28:Ourwares/yscanf.c **** 		sscanfSemaphoreHandle = osSemaphoreCreate(osSemaphore(sscanfSemaphore), 1);
  55              		.loc 1 28 0
  56 0016 0121     		movs	r1, #1
  57 0018 6846     		mov	r0, sp
  58 001a FFF7FEFF 		bl	osSemaphoreCreate
  59              	.LVL0:
  60 001e 064B     		ldr	r3, .L5+4
  61 0020 1860     		str	r0, [r3]
  62              	.LBE2:
  29:Ourwares/yscanf.c **** 	}
  30:Ourwares/yscanf.c **** 	return sw;
  31:Ourwares/yscanf.c **** }
  63              		.loc 1 31 0
  64 0022 044B     		ldr	r3, .L5
  65 0024 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
  66 0026 03B0     		add	sp, sp, #12
  67              	.LCFI2:
  68              		.cfi_def_cfa_offset 4
  69              		@ sp needed
  70 0028 5DF804FB 		ldr	pc, [sp], #4
  71              	.L4:
  72              	.LCFI3:
  73              		.cfi_def_cfa_offset 0
  74              		.cfi_restore 14
  75 002c 014B     		ldr	r3, .L5
  76 002e 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
  77 0030 7047     		bx	lr
  78              	.L6:
  79 0032 00BF     		.align	2
  80              	.L5:
  81 0034 00000000 		.word	.LANCHOR0
  82 0038 00000000 		.word	sscanfSemaphoreHandle
  83              		.cfi_endproc
ARM GAS  /tmp/ccr4ARcs.s 			page 3


  84              	.LFE129:
  86              		.section	.text.yscanf,"ax",%progbits
  87              		.align	2
  88              		.global	yscanf
  89              		.thumb
  90              		.thumb_func
  92              	yscanf:
  93              	.LFB130:
  32:Ourwares/yscanf.c **** /* **************************************************************************************
  33:Ourwares/yscanf.c ****  *  int yscanf(char* pline, const char *fmt, ...);
  34:Ourwares/yscanf.c ****  * @brief	: 'sscanf' for uart input
  35:Ourwares/yscanf.c ****  * @param	: pline = pointer to stuct with uart pointers and buffer parameters
  36:Ourwares/yscanf.c ****  * @param	: format = usual scanf format
  37:Ourwares/yscanf.c ****  * @param	: ... = usual scanf arguments
  38:Ourwares/yscanf.c ****  * @return	: Number of items matched
  39:Ourwares/yscanf.c ****  * ************************************************************************************** */
  40:Ourwares/yscanf.c **** int yscanf(char* pline, const char *fmt, ...)
  41:Ourwares/yscanf.c **** {
  94              		.loc 1 41 0
  95              		.cfi_startproc
  96              		@ args = 4, pretend = 12, frame = 8
  97              		@ frame_needed = 0, uses_anonymous_args = 1
  98              	.LVL1:
  99 0000 0EB4     		push	{r1, r2, r3}
 100              	.LCFI4:
 101              		.cfi_def_cfa_offset 12
 102              		.cfi_offset 1, -12
 103              		.cfi_offset 2, -8
 104              		.cfi_offset 3, -4
 105 0002 F0B5     		push	{r4, r5, r6, r7, lr}
 106              	.LCFI5:
 107              		.cfi_def_cfa_offset 32
 108              		.cfi_offset 4, -32
 109              		.cfi_offset 5, -28
 110              		.cfi_offset 6, -24
 111              		.cfi_offset 7, -20
 112              		.cfi_offset 14, -16
 113 0004 82B0     		sub	sp, sp, #8
 114              	.LCFI6:
 115              		.cfi_def_cfa_offset 40
 116 0006 0646     		mov	r6, r0
 117 0008 07AC     		add	r4, sp, #28
 118 000a 54F8047B 		ldr	r7, [r4], #4
  42:Ourwares/yscanf.c **** 	va_list argp;
  43:Ourwares/yscanf.c **** 	int itemct;		// Number of items matched
  44:Ourwares/yscanf.c **** 
  45:Ourwares/yscanf.c **** 	yscanf_init();	// JIC not init'd
 119              		.loc 1 45 0
 120 000e FFF7FEFF 		bl	yscanf_init
 121              	.LVL2:
  46:Ourwares/yscanf.c **** 
  47:Ourwares/yscanf.c **** 	/* Block if sscanf is being uses by someone else. */
  48:Ourwares/yscanf.c **** 	xSemaphoreTake( sscanfSemaphoreHandle, portMAX_DELAY );
 122              		.loc 1 48 0
 123 0012 0D4D     		ldr	r5, .L9
 124 0014 0023     		movs	r3, #0
 125 0016 4FF0FF32 		mov	r2, #-1
ARM GAS  /tmp/ccr4ARcs.s 			page 4


 126 001a 1946     		mov	r1, r3
 127 001c 2868     		ldr	r0, [r5]
 128 001e FFF7FEFF 		bl	xQueueGenericReceive
 129              	.LVL3:
  49:Ourwares/yscanf.c **** 
  50:Ourwares/yscanf.c **** 	/* Construct line of data.  Stop filling buffer if it is full. */
  51:Ourwares/yscanf.c **** 	va_start(argp, fmt);
  52:Ourwares/yscanf.c **** 	va_start(argp, fmt);
 130              		.loc 1 52 0
 131 0022 0194     		str	r4, [sp, #4]
  53:Ourwares/yscanf.c **** 	itemct = vsscanf(pline, fmt, argp);
 132              		.loc 1 53 0
 133 0024 2246     		mov	r2, r4
 134 0026 3946     		mov	r1, r7
 135 0028 3046     		mov	r0, r6
 136 002a FFF7FEFF 		bl	vsscanf
 137              	.LVL4:
 138 002e 0446     		mov	r4, r0
 139              	.LVL5:
  54:Ourwares/yscanf.c **** 	va_end(argp);
  55:Ourwares/yscanf.c **** 
  56:Ourwares/yscanf.c **** 	/* Release semaphore controlling sscanf. */
  57:Ourwares/yscanf.c **** 	xSemaphoreGive( sscanfSemaphoreHandle );
 140              		.loc 1 57 0
 141 0030 0023     		movs	r3, #0
 142 0032 1A46     		mov	r2, r3
 143 0034 1946     		mov	r1, r3
 144 0036 2868     		ldr	r0, [r5]
 145              	.LVL6:
 146 0038 FFF7FEFF 		bl	xQueueGenericSend
 147              	.LVL7:
  58:Ourwares/yscanf.c **** 
  59:Ourwares/yscanf.c **** 	return itemct;
  60:Ourwares/yscanf.c **** }
 148              		.loc 1 60 0
 149 003c 2046     		mov	r0, r4
 150 003e 02B0     		add	sp, sp, #8
 151              	.LCFI7:
 152              		.cfi_def_cfa_offset 32
 153              		@ sp needed
 154 0040 BDE8F040 		pop	{r4, r5, r6, r7, lr}
 155              	.LCFI8:
 156              		.cfi_restore 14
 157              		.cfi_restore 7
 158              		.cfi_restore 6
 159              		.cfi_restore 5
 160              		.cfi_restore 4
 161              		.cfi_def_cfa_offset 12
 162              	.LVL8:
 163 0044 03B0     		add	sp, sp, #12
 164              	.LCFI9:
 165              		.cfi_restore 3
 166              		.cfi_restore 2
 167              		.cfi_restore 1
 168              		.cfi_def_cfa_offset 0
 169 0046 7047     		bx	lr
 170              	.L10:
ARM GAS  /tmp/ccr4ARcs.s 			page 5


 171              		.align	2
 172              	.L9:
 173 0048 00000000 		.word	sscanfSemaphoreHandle
 174              		.cfi_endproc
 175              	.LFE130:
 177              		.comm	sscanfSemaphoreHandle,4,4
 178              		.section	.bss.sw,"aw",%nobits
 179              		.set	.LANCHOR0,. + 0
 182              	sw:
 183 0000 00       		.space	1
 184              		.text
 185              	.Letext0:
 186              		.file 2 "/home/deh/launchpad/gcc-arm-none-eabi-5_4-2016q3/arm-none-eabi/include/machine/_default_t
 187              		.file 3 "/home/deh/launchpad/gcc-arm-none-eabi-5_4-2016q3/arm-none-eabi/include/sys/_stdint.h"
 188              		.file 4 "/home/deh/launchpad/gcc-arm-none-eabi-5_4-2016q3/lib/gcc/arm-none-eabi/5.4.1/include/stda
 189              		.file 5 "Middlewares/Third_Party/FreeRTOS/Source/portable/GCC/ARM_CM4F/portmacro.h"
 190              		.file 6 "<built-in>"
 191              		.file 7 "Middlewares/Third_Party/FreeRTOS/Source/include/FreeRTOS.h"
 192              		.file 8 "Middlewares/Third_Party/FreeRTOS/Source/include/queue.h"
 193              		.file 9 "Middlewares/Third_Party/FreeRTOS/Source/include/semphr.h"
 194              		.file 10 "Middlewares/Third_Party/FreeRTOS/Source/CMSIS_RTOS/cmsis_os.h"
 195              		.file 11 "Drivers/CMSIS/Include/core_cm4.h"
 196              		.file 12 "/home/deh/launchpad/gcc-arm-none-eabi-5_4-2016q3/arm-none-eabi/include/stdio.h"
ARM GAS  /tmp/ccr4ARcs.s 			page 6


DEFINED SYMBOLS
                            *ABS*:00000000 yscanf.c
     /tmp/ccr4ARcs.s:22     .text.yscanf_init:00000000 $t
     /tmp/ccr4ARcs.s:27     .text.yscanf_init:00000000 yscanf_init
     /tmp/ccr4ARcs.s:81     .text.yscanf_init:00000034 $d
                            *COM*:00000004 sscanfSemaphoreHandle
     /tmp/ccr4ARcs.s:87     .text.yscanf:00000000 $t
     /tmp/ccr4ARcs.s:92     .text.yscanf:00000000 yscanf
     /tmp/ccr4ARcs.s:173    .text.yscanf:00000048 $d
     /tmp/ccr4ARcs.s:182    .bss.sw:00000000 sw
     /tmp/ccr4ARcs.s:183    .bss.sw:00000000 $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
osSemaphoreCreate
xQueueGenericReceive
vsscanf
xQueueGenericSend
